<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bem-vindo! - Montador de Serm√µes 3.3</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="/manifest.json">
    
    <script src="pwa-installer.js" defer></script>

    <!-- BLOCO DE C√ìDIGO FINAL E CORRIGIDO -->
    <script
      src="https://browser.sentry-cdn.com/7.117.0/bundle.min.js"
      crossorigin="anonymous"
    ></script>
    <script>
      Sentry.init({
        dsn: "https://681f52ee4a2930c13a0fd8abc7b7487c@o4510002850824192.ingest.us.sentry.io/4510002863407104",
      });
    </script>

    <style>
        .verses-button {
            margin-top: 20px;
            background-color: #FF6B00;
            color: #ffffff;
            border: none;
            border-radius: 999px;
            padding: 14px 24px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            max-width: 360px;
        }
    </style>
    
</head>
<body>
    <header>
        <img src="https://cdn.glitch.global/db74bd9b-d683-421c-994e-9974e97a4e55/montador-de-sermoes-logo.png?v=1734385573934" alt="Logo do Montador de Serm√µes 3.3" class="logo">
    </header>
    
    <div class="welcome-container">
        <h1>Parab√©ns!</h1>
        <p>Seja bem-vindo ao Montador de Serm√µes 3.3. Para a melhor experi√™ncia, recomendamos instalar o atalho do aplicativo em seu dispositivo.</p>
        
        <button id="start-button" class="start-button">Come√ßar a Usar</button>

        <button id="verses-button" class="verses-button">
            üìñ Vers√≠culos para Ocasi√µes (Novo)
        </button>
    </div>

    <script>
        // L√≥gica final e corrigida para instala√ß√£o e redirecionamento

        const startButton = document.getElementById('start-button');

        function updateButtonState() {
            // Agora verificamos window.deferredPrompt, que √© preenchido pelo pwa-installer.js
            if (window.deferredPrompt) {
                startButton.innerText = 'Instalar e Come√ßar';
            }
        }
        
        window.addEventListener('load', () => {
          setTimeout(updateButtonState, 200);
        });

        startButton.addEventListener('click', async () => {
            // Se o app for instal√°vel, primeiro mostra o prompt
            if (window.deferredPrompt) {
                window.deferredPrompt.prompt();
                
                // Aguarda a escolha do usu√°rio antes de continuar
                const { outcome } = await window.deferredPrompt.userChoice;
                
                console.log(`Resultado da instala√ß√£o: ${outcome}`);
                
                window.deferredPrompt = null; // Limpa a refer√™ncia
            }
            
            // Sempre redireciona para o app ap√≥s a tentativa de instala√ß√£o (ou se n√£o houver prompt)
            window.location.href = '/app';
        });

        const versesButton = document.getElementById('verses-button');
        if (versesButton) {
            versesButton.addEventListener('click', () => {
                window.location.href = '/versiculos';
            });
        }
    </script>
</body>
</html>
